More functions n neasted loops
